# Кононюк Артем grebnik89@gmail.com

# Тестовое задание для DevOps-инженера

Проект состоит из README.md с ответами на вопросы, картинкой из 9 задания, а также Dockerfile и docker-compose.yml для 10 практического задания.

1. Общие концепции DevOps: опишите, что такое DevOps и какие проблемы оно решает в процесе разработки и эксплуатации ПО.

Ответ: исходя из расшифровки названия DevOps - Development & Operations (разработка и операции или поддержка), это методология, идея которой заключается в налаживании и повышении эффективности этих двух связанных жизненных этапов любого ПО.

Проблем может быть множество: начиная от проблем взаимодействия между отделами разработки (разработчики, эксплуатация и безопасники), заканчивая совместимостью самих версий ПО и в конце концов возникновением багов. Есть такое понятие "Функциональные колодцы", это когда существует изолированность групп, команд и целых отделов, замедляется поиск ошибок и их последующее исправление, образуются простои, тратится огромное количество времени на поиск виновных и ответственных, а также напрочь рассеивается понятие того, кто и сколько будет выполнять определённые задачи. Параллельно с этим бизнес теряет время и деньги. DevOps как раз и нацелен на искоренение проблем функциональных колодцев.

В более прикладном смысле, DevOps инженер обычно занимается такими проблемами, как:
* написание кода пайплайна CI/CD
* настройка и дебаг серверов, начиная от прав пользователей, заканчивая управлением кластерами в облаке
* хранение и настройка использования секретов и артефактов
* оптимизация инфраструктуры для масштабирования
* обеспечение безопасности

пс: отдельно хочется отметить вопросы безопасности, которые породили даже отдельное направление DevSecOps, но конечно в общих чертах DevOps инженер должен знать и понимать основные требования и обеспечивать безопасность на должном уровне.

2. CI/CD: объясните, что такое CI/CD и почему оно важно в DevOps, перечислите основные этапы CI/CD пайплайна.

Ответ: CI/CD (Continuous Integration and Continuous Deployment) - по сути как раз тот главный способ или подход к решению проблем, описанных выше. Это идея непрерывной автоматизированной поставки продукта, когда с помощью кода мы можем от разработки перейти сразу в автоматическое тестирование и далее, если всё успешно, также автоматически развернуть новую версию продукта.

Это важно в DevOps, потому что:

-   Позволяет снизить затраты на исправление ошибок
-   Ускорить выход продукта за счет уменьшения ручной работы
-   Улучшить качество продукта
-   Повысить удовлетворенность пользователей

Основные этапы:

-   Создание кода.
-   Автоматическое тестирование. Тестируем написанный код.
-   Сборка приложения. Установка зависимостей, передача переменных среды, запуск
-   Снова тесты, только уже на тестовом сервере, убеждаемся в работоспособности приложения
-   Деплой на продакшен сервер, есть разные стратегии, например blue/green, когда старая версия отключается и удаляется только после проверки жизнеспособности новой.

3. Мониторинг и логирование. Зачем необходимо в DevOps, какие инструменты знаете и объясните различие между логированием и мониторингом.

Ответ: мониторинг и логирование необходимы в DevOps, чтобы выявлять проблемы на ранних стадиях, улучшать производительность и обеспечивать безопасность. Самые измвестные инструменты, пожалуй: Grafana и Prometheus. Есть еще Zabbix, Nagios, ELK stack.

Различия между мониторингом и логированием в том, что первое используется скорее на уровне взаимодействия с пользователем, сбор метрик, чтобы понять, насколько эффективен наш сервис, а также выявить проблемы на ранних стадиях, а второе - для понимания состояния самого сервиса, в том числе во время взаимодействия с пользователем. Логирование удобно осуществлять с помощью разных утилит: journalctl, top, kubectl logs, k9s, docker logs, и тд

4. Контейнеризация и Docker, что такое контейнеры и чем отличаются от виртуальных машин, основные команды Docker

Ответ: контейнеры - это по сути изолированные среды, которые могут запускать приложения, при этом им не нужна отдельная операционная система, в отличие от виртуальных машин, тем самым обеспечивается более эффективное расходование ресурсов. Процесс, запущенный в контейнере, "думает" что он один и первый в системе, с точки зрения безопасности опять же мы получаем бонус - вредоносному ПО нужно еще выбраться из контейнера, чтобы как-то навредить чему-то еще.

Контейнерная функциональность заложена в ядро Linux, однако на практике чаще используют среды выполнения контейнеров (Container Engine), типа Docker, containerd и cri-o. Основные команды docker, которые приходится использовать разработчику чаще всего:

-   docker ps
-   docker images
-   docker rm
-   docker rmi
-   docker build
-   docker run
-   docker stop/start/restart
-   docker inspect
-   docker logs -f
-   docker exec
-   docker container ls

5. Сетевые основы: что такое NAT и как работает, что такое DNS и как используется в сетях.

Ответ: технология NAT (Network Address Translation) по сути преобразует приватные IP-адреса во внешние и наоборот. Благодаря этому виртуальная машина получает доступ в интернет, или, если она не одна, то множеству устройств в локальной сети использовать один публичный IP-адрес для общения с внешним миром. Работает как преобразователь, когда устройство хочет отправить данные в интернет, NAT преобразует приватный IP-адрес этого устройства в публичный IP-адрес маршрутизатора, что позволяет экономить количество публичных IP адресов.

DNS (Domain Name System) - это система получения информации об удаленных хостах, чаще всего используется для получения IP по доменному имени, либо например информации о маршрутизации почты. Представляет распределенную базу данных, поддерживается с помощью иерархии DNS-серверов, взаимодействующих по определенному протоколу.

Основные функции:

-   поиск IP адресов по доменному имени
-   Ускорение доступа с помощью кэширования популярных запросов
-   Маршрутизация к ближайшему серверу, что также уведичивает скорость загрузки
-   Фильтрация. Может защитить пользователя от некоторых видов угроз

6. Git, что такое ветвление, зачем оно нужно, как создать новую ветку и переключиться на нее

Ответ: Git - очень удобная штука для хранения кода, его совместной разработки, а сегодня еще и создания CI/CD пайплайнов, как например сегодня может Gitlab CI/CD. Но в основе своей - это способ хранения и обновления кода, которое похоже на хранение состояния в виде снимков. Чтобы несколько человек могли работать над одним и тем же кодом каждый на своем устройстве, гит позволяет загружать локально текущее состояние кода и после фиксировать и публиковать удаленно обновленные версии - коммиты. Чтобы разработчики могли быть уверены в том, что они не сломают основную версию, эта версия как правила хранится в главной ветке, а для разработки или исправления ошибок создаются дополнительные - это и есть ветвление. Работа ведется в них и после изменения кода и проверки или тестов, сливаются в главную. Веток может быть много и они могут создаваться от разных веток и коммитов, в зависимости от цели создания. Есть модель ветвления Git-flow, где как раз описаны основные принципе ветвления.

Работая локально мы можем создать новую ветку branchname и сразу переключится на нее командой: 
```
git checkout -b branchname
```

7. Безопасность: основные методы для серверов и сервисов, что такое SSH и как используют для безопасного доступа к серверам

Ответ: безопасность - тема конечно очень обширная. Основые методы:

-   Регулярные обновления версий и зависимостей, внедрение качественных валидаций в код, своевременное обновление ПО ОС и тд
-   Использование брэндмауэра и антивируса. Фаерволы отфильтруют трафик, а антивирусные ПО обнаружат вирусы
-   Физические сервера должны быть качественно изолированы, без доступа посторонних конечно же
-   Шифрование SSL/TLS, https наше всё
-   Разделение сред разработки, тестирования и прода.
-   Грамотное управление разрешениями и привилегиями на уровне железа, например создание отдельных юзеров для запуска приложений, а не запуск их из подпользователя root
-   Регулярное бэкапирование. Его лучше автоматизировать и создать расписание, и если вдруг - удобно и быстро откатиться.
-   Мониторинг и логирование, писал выше о них, позволяют на ранних стадиях обнаружить подозрительную активность
-   Удаление ненужных сервисов, приложений, подов и нод в кластере, вм, вообще чем меньше сущностей - тем меньше поверхность для атаки
-   Обучение сотрудников

В целом защита серверов - непрерывный процесс и конечно крайне важный, есть отдельное направление DevSecOps, но для специалиста DevOps понимание этих меанизмов крайне необходимо.

SSH (Secure Shell) - сетевой протокол для безопасного доступа к удаленным компьютерам и серверам. Шифрует данные, защищает от перехвата и подделки, используется для выполнения команд, удаленного управления устройствами, передачи данных и тп. Как используют - подключение происходит с помощью команды `ssh user@<IP address>`, может испольоваться обычный пароль, но лучшей практикой считается создание ssh ключей, которые представляют собой пару - закрытый (private) и открытый (public) ключи. Открытый кладется на сервер в специальную папку в каталоге пользователя, который идет на сервер, закрытый хранится только у пользователя и нигде не компрометируется, это важно. При попытке входа сервер отправит случайное сообщение для проверки, клиент шифрует его с помощью закрытого ключа и отправляет обратно. Дальше сервер проверяет, получится ли его расшифровать с помощью открытого ключа, и если да — аутентификация пройдена.

8. Оркестрация, что такое, зачем нужна. Какие оркестраторы знаете и используете.

Ответ: оркестрация — это процесс автоматизации развертывания, управления и масштабирования контейнеров в контексте некой большой группы взаимосвязанных приложений - кластере.
Зачем нужна:
-   Упростить управление сложными системами. С помощью оркестрации можно управлять ресурсами, отслеживать производительность, автоматизировать задачи.
-   Управлять контейнерами с программами. Оркестрация нужна для управления жизненным циклом контейнеров, их масштабированием и развёртыванием.
-   Помогать в работе облачных сервисов. Оркестрация помогает управлять множеством виртуальных машин, сетевыми устройствами, хранилищами данных и другими компонентами инфраструктуры
-   Обеспечивать безопасность. Оркестраторы оснащены функциями защиты данных и приложений, например шифрованием трафика и авторизацией пользователей.

Наверно самое популярное решение конечно Kubernetes, с ним плотно взаимодействовал. Но также знаю такие системы, как:
-   Docker Swarm
-   Apache Mesos c кучей фреймворков: Aurora, Marathon, Chronos, Ceph и пр
-   Nomad от HashiCorp

9. docker-compose.yml файл что делает, шаги для запуска, как изменить файл, чтобы добавить том для хранения данных PostgreSQL.

-   В файле описан манифест для развертывания двух сервисов: прокси-сервера Nginx и баз данных PostgreSQL. Для первого указаны порты, будет настроено отображение порта 8080 на хостовой машине на порт 80 в контейнере, для второго переменные окружения, необходимые для доступа к базе данных
-   Шаги для запуска: переходим в папку с файлом docker-compose.yml, вводим команду `docker compose up -d --name app `, флаг -d реализует detached режим, чтобы процесс сразу отдал нам консоль, --name укажет имя создаваемого сервиса, также можно передать необходимые переменные через флаг --env, указать сеть в --network, стратегию перезапуска в --retart и тд
-   Том для хранения данных настраивается конфигурацией volumes. Возможный вариант решения:

```
ports:
  # проброс портов, 8080:5432 означает, что порт PostgreSQL внутри контейнера проброшен на порт хоста 8080
  - "8080:5432"
volumes:
  # монтируем локальный каталог ./pgdata внутрь контейнера для сохранения данных PostgreSQL.
  - ./pgdata:/var/lib/postgresql/data/pgdata
```

10. Практическое задание.
